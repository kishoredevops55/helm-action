- id: nonprod_values_must_not_contain_prod
  enabled: true
  type: regex
  severity: critical

  description: "Nonprod values files must not reference prod endpoints"

  # SINGLE-LINE match ONLY
  match: '(?i)^\s*value\s*:\s*.*prod'

  file_pattern:
    - '.*[\\/](nonprod|dev|perf|perf1|qa|stage)[\\/].*values.*\.ya?ml$'
    - '.*values.*(nonprod|dev|perf|perf1|qa|stage).*\.ya?ml$'

  condition: must_not_exist

  message: "CRITICAL: Nonprod values file contains prod reference"
  suggestion: "Replace prod endpoint with nonprod equivalent"

  ignore_keys: []
  ignore_values: []
  ignore_files: []
