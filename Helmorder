# values.yaml
orderedFolders:
  - distributor
  - ingester
  - compactor
  - querier


{{- /*
  Define a named template that renders all YAML files in a given folder.
  The folder is expected to be inside the "manifests" directory.
  It uses Files.Glob to retrieve the files and tpl to render them as templates.
*/ -}}
{{- define "mimir.renderFolder" -}}
  {{- $folder := .folder -}}
  {{- $files := .Files.Glob (print "manifests/" $folder "/*.yaml") | sort }}
  {{- range $f := $files }}
{{ tpl $f.String $. | nindent 2 }}
  {{- end }}
{{- end }}

{{- /*
  Loop over the list provided in .Values.orderedFolders.
  For each folder name, call the defined template "mimir.renderFolder".
*/ -}}
{{- range .Values.orderedFolders }}
  {{- $folderName := . }}
  {{- include "mimir.renderFolder" (dict "folder" $folderName "Values" $.Values) | nindent 0 }}
{{- end }}
